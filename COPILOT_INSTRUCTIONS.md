# Copilot 指示事項 / 利用ガイド

このファイルは、このリポジトリで GitHub Copilot や自動化エージェント（以下「Copilot」）が作業する際の指示書です。
エージェントはここに書かれた方針に従い、安全かつ一貫性のある変更のみ行ってください。

---

## 1. プロジェクトの目的

- 小さな Raspberry Pi 向けの Python 時計アプリケーション（デモ・雛形）。
- 主要な作業: テストが通ること、パッケージが読みやすいこと、CI が正常に動作すること。

## 2. リポジトリ構成（参照）

- `src/rpi_clock/` — 本体ソース
- `.github/workflows/ci.yml` — CI 定義
- `pyproject.toml`, `requirements.txt`, `README.md`, `LICENSE`

## 3. 言語・実行環境

- Python 3.9〜3.11 をサポート対象（CI 参照）
- 開発環境ではユーザーが仮想環境を作ることを想定する（`.venv` は削除済み）。システム全体へパッケージを勝手に書き換えないこと。

## 4. 変更方針（必須ルール）

1. 目的に関係ない大きなリファクタや設計変更は行わない（許可がある場合を除く）。
2. すべての Python 変更は対応するテストを含めるか、既存テストが壊れないことを確認すること。
3. 依存関係を追加する場合は `requirements.txt` と `pyproject.toml` の両方を更新し、変更理由をコミットメッセージに明記する。
4. 外部へのアクセスやシークレット（API トークン、パスワードなど）をコードに埋め込まない。絶対に `secrets` をコミットしない。
5. ローカル環境で `sudo` を必要とする操作はユーザーの明示的な許可なしに実行しない。

## 5. コーディングスタイル・品質

- 既存コードに合わせたシンプルで可読性の高いスタイルを優先する。
- 自動整形／リンティング: `black` / `ruff` の導入を提案して良いが、導入する場合は CI へも追加し、別コミットで行う。
- ドキュメント文字列は日本語で短く要点を記載して良い（既存コードに倣う）。ただし API レベルの公開ライブラリを作る場合は英語ドキュメントを検討する。

## 6. テスト方針

- 現在このリポジトリには pytest ベースのテストは含まれていません。
- もし将来テストを追加する場合は、ユニットテストを `tests/` に配置し、`PYTHONPATH=src pytest` または仮想環境内で実行できるようにしてください。

## 7. CI（GitHub Actions）に関するルール

- 変更は CI が通ることが必須。CI ワークフローは現状 `ci.yml` により Python 3.9–3.11 で実行される。
- 依存追加やリンター導入は CI へステップを追加する必要がある。

## 8. Git / ブランチ / コミット

- デフォルトブランチは `main`。
- 小さな変更は直接 `main` に push して良いが、機能追加や破壊的変更はブランチを切り、PR を経てマージすることを推奨する。
- コミットメッセージは英語か日本語で短く要点を記述する（例: "Fix: remove markdown fences from __init__"、"Add: README usage examples"）。

## 9. リモート操作・認証

- リモートは SSH を推奨（`git@github.com:nori-tama/rpi-clock.git`）。HTTPS を使う場合は PAT を使うこと。
- Copilot がリモート作成や push を行う場合はユーザーによる事前承認を得ること。

## 10. セキュリティとプライバシー

- ユーザーの個人情報やトークンをログやコミットに残さない。
- 外部ネットワークへアクセスするコード（アップデート、ダウンロード等）を追加する場合は必ず理由を明記し、レビューを受けること。

## 11. 具体的に実行して良いタスク（例）

- README の改善、軽微なバグ修正、CI の小さな改良、パッケージ設定の整備（`pyproject.toml`）
- 既存の Markdown フェンスや余分なトークンを除去するようなテキスト修正

## 12. 禁止事項（明示）

- ライセンスの無断変更、ユーザーの代わりに GitHub 上のシークレット登録や公開リポジトリの設定を勝手に変更すること。

## 13. 作業ログの残し方

- 自動変更を行った場合はコミットメッセージと PR 説明に "Copilot: <短い説明>" を付け、変更理由とテストの有無を明記すること。

---

このファイルは必要に応じて更新してください。大きな方針変更を行う場合はリポジトリ所有者と合意の上で更新すること。
